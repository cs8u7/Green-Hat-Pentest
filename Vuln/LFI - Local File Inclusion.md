## Define
- a vuln allows user include and execute an already exist file form client to browser by input param
- relative to path traversal
## Root Cause
- Same as path traversal, do not filter user input -> user can handle param to access file system -> execute file
## Bypass
- i consider that this is a php code in a vuln web site
```
<?php include($_GET['file'].".php"); ?>
```
- i see that the web site get data from param `file`, then there is no input filter here so i can access to `/etc/passwd`
```
http://vulnerable_host/preview.php?file=../../../../etc/passwd%00
```
- the null character (null terminator or null byte) `%00` which is used as a mark of line ending. After this mark, all the character in command is non sense -> cut php extension -> access to `/ect/passwd`
### PHP ZIP
- the zip wrapper in php `zip://` is used to access a file in a zip in php file server
- so the idea is create or upload a 'zip' file to web server then access it by this wrapper
- create a `code.php` file with content is a easy payload to proof that the place we upload or include php file can execute php
```
<?php phpinfo(); ?>
```
- zip that file to `target.zip` (we can change zip file's extension to bypass filter of web server. Ex: `target.jpg`,...)
- supposing that web server would store all upload avatar at folder `../avatar` so we can access write to the code.php file by this payload
```
http://idunno/profile.php?file=zip://../avatar/target.jpg%23code
```
- But, by the concept of php execution file, this payload just use to read file and can not execute the file. Just work in case the server config execute all shit they can find
### PHP DATA
- usage: `data://text/plain;base64,BASE64_STR` where `BASE64_STR` is expected to be the base64 encoded content of the file to be processed
- only work if `allow_url_include` would be enable in server config
- for example, i encode a file php content `<?php phpinfo(); ?>` to `PD9waHAgcGhwaW5mbygpOyA/Pg==`-> so the payload is `data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==`.
### PHP Expect
This wrapper, which is not enabled by default, provides access to processes `stdio`, `stdout` and `stderr`. Expecting to be used as `expect://command` the server would execute the provided command on `BASH` and return it’s result.
